# OC-Memory

**OpenClaw never forgets.**

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-3776AB?logo=python&logoColor=white)](https://www.python.org/downloads/)
[![Rust](https://img.shields.io/badge/guardian-Rust-DEA584?logo=rust&logoColor=white)](https://www.rust-lang.org/)
[![Tests: 228](https://img.shields.io/badge/tests-228_passing-brightgreen)]()
[![License: MIT](https://img.shields.io/badge/license-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Platform](https://img.shields.io/badge/platform-Windows%20%7C%20macOS%20%7C%20Linux-lightgrey)]()

---

# ğŸ’¾ OC-Memory & ğŸ›¡ï¸ OC-Guardian

OC-MemoryëŠ” OpenClaw ê°€ 90ì¼ ì „ì˜ ëŒ€í™”ë„ ìƒìƒí•˜ê²Œ ê¸°ì–µí•˜ë©°, ì§€ì—° ì—†ì´ ë¹ ë¥´ê²Œ ë‹µë³€ì„ ì œê³µí•˜ëŠ” ì§€ëŠ¥í˜• ë©”ëª¨ë¦¬ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

---

## ğŸ§  OC-Memory: AIì˜ ë˜‘ë˜‘í•œ ê¸°ì–µ ì €ì¥ì†Œ
AIê°€ ì˜ˆì „ì— í–ˆë˜ ë§ì„ ìŠì§€ ì•Šë„ë¡ ë„ì™€ì£¼ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

| ê¸°ëŠ¥ | ê¸°ìˆ  ëª…ì¹­ (Technical) | ëˆˆë†’ì´ ì„¤ëª… (Easy) |
| :--- | :--- | :--- |
| **ì²´ê³„ì  ì €ì¥** | 3-Tier ë©”ëª¨ë¦¬ ì•„í‚¤í…ì²˜ | ê¸°ì–µì„ 3ë‹¨ê³„ë¡œ ë‚˜ëˆ„ì–´ ì¤‘ìš”í•œ ê²ƒë¶€í„° ì°¨ê³¡ì°¨ê³¡ ì •ë¦¬í•´ìš”. |
| **ë¹„ìš© ì ˆê°** | AI ë©”ëª¨ë¦¬ ì••ì¶• (Mastra) | ê¸°ì–µì„ ì‘ê²Œ ì ‘ì–´ì„œ ë³´ê´€í•´ AI ì‚¬ìš©ë£Œë¥¼ 90%ë‚˜ ì•„ê»´ìš”. |
| **ê°„í¸ ì„¤ì¹˜** | Zero-Core-Modification | ì›ë˜ í”„ë¡œê·¸ë¨ì„ ê³ ì¹˜ì§€ ì•Šê³ ë„ ìƒˆë¡œìš´ ëŠ¥ë ¥ì„ ì™ ì¶”ê°€í•´ìš”. |
| **ìë™ ì²­ì†Œ** | ë°ì´í„° ìˆ˜ëª… ì£¼ê¸° ê´€ë¦¬ (TTL) | ë„ˆë¬´ ì˜¤ë˜ë˜ì–´ í•„ìš” ì—†ëŠ” ê¸°ì–µì€ ìŠ¤ìŠ¤ë¡œ ì§€ì›Œ ìš©ëŸ‰ì„ ì§€ì¼œìš”. |
| **ì°°ë–¡ ì´í•´** | ì˜ë¯¸ ê¸°ë°˜ ê²€ìƒ‰ (Semantic Search) | ë‹¨ì–´ê°€ ì¡°ê¸ˆ í‹€ë ¤ë„ "ê·¸ê±° ìˆì–ì•„!" í•˜ë©´ ëœ»ì„ ì´í•´í•˜ê³  ì°¾ì•„ë‚´ìš”. |

---

## ğŸ›¡ï¸ OC-Guardian: ë“ ë“ í•œ AI ê´€ë¦¬ì (NEW!!)
OC-Guardianì€ **Rust ê¸°ë°˜**ìœ¼ë¡œ ì œì‘ë˜ì–´, OpenClawì™€ OC-Memoryê°€ ì•ˆì •ì ìœ¼ë¡œ ëŒì•„ê°€ë„ë¡ ê°ì‹œí•˜ê³  ì§€ì¼œì£¼ëŠ” 'ë³´ë””ê°€ë“œ' ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

> **"OpenClawê°€ ë©ˆì¶”ê±°ë‚˜ ì„œë²„ê°€ ë‹¤ìš´ë˜ëŠ” ê²ƒì„ ì ˆëŒ€ í—ˆìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."**

### âœ¨ ì£¼ìš” ê¸°ëŠ¥
* **âš¡ ì›í„°ì¹˜ ì‹¤í–‰**: AIì—ê²Œ **"OC-Guardian ì‹œì‘í•´ì¤˜"**ë¼ê³  ë§í•˜ì„¸ìš”. (OpenClaw â†’ OC-Memory ìˆœì„œë¡œ ìë™ ì‹¤í–‰)
* **ğŸ©º 5ë‹¨ê³„ ì •ë°€ ê²€ì§„**: í”„ë¡œê·¸ë¨ì´ ì•„í”ˆ ê³³ì€ ì—†ëŠ”ì§€ 5ë‹¨ê³„ë¡œ ë‚˜ëˆ„ì–´ ê¼¼ê¼¼í•˜ê²Œ ì²´í¬í•´ìš”.
* **ğŸš‘ ìë™ ì‘ê¸‰ì²˜ì¹˜**: ë¬¸ì œê°€ ìƒê¸°ë©´ ì •í•´ì§„ ì‹œë‚˜ë¦¬ì˜¤ì— ë”°ë¼ ìŠ¤ìŠ¤ë¡œ ë³µêµ¬í•˜ê³  ë‹¤ì‹œ ì‹œì‘í•´ìš”.
* **ğŸ§¹ ë¬´í•œ ìš©ëŸ‰ ê´€ë¦¬**: ê¸°ë¡(ë¡œê·¸)ì´ ìŒ“ì—¬ì„œ ì»´í“¨í„°ê°€ ëŠë ¤ì§€ì§€ ì•Šê²Œ ìë™ìœ¼ë¡œ ì²­ì†Œí•´ìš”.
* **ğŸ“§ ì¦‰ì‹œ ì•Œë¦¼**: í„°ë¯¸ë„ì´ ì¬ì‹œì‘ë˜ëŠ” ë“± ì¤‘ìš”í•œ ì¼ì´ ìƒê¸°ë©´ ì´ë©”ì¼ë¡œ ë°”ë¡œ ì•Œë ¤ì¤˜ìš”.
* **ğŸ›Œ ì ë“¦ ë°©ì§€**: ë§¥ë¶ ëšœê»‘ì„ ë®ì–´ë„ í”„ë¡œê·¸ë¨ì´ ì¢…ë£Œë˜ì§€ ì•Šê³  ê³„ì† ì¼í•  ìˆ˜ ìˆê²Œ ì§€ì¼œì¤˜ìš”. (MacBook ìŠ¬ë¦½ ë°©ì§€)

---

### ğŸ› ï¸ ì„¤ì¹˜ ë° ì‹œì‘í•˜ê¸°
```bash
# OC-Guardianë§Œ ì‹¤í–‰í•˜ë©´ ëª¨ë“  ì‹œìŠ¤í…œì´ ìˆœì°¨ì ìœ¼ë¡œ ê°€ë™ë©ë‹ˆë‹¤.
./oc-guardian start
```

| What | How |
|------|-----|
| **90% í† í° ì ˆì•½** | 5-40x ì••ì¶•ìœ¼ë¡œ ë¹„ìš© ëŒ€í­ ì ˆê° |
| **Zero-Core-Mod** | OpenClaw ì†ŒìŠ¤ ìˆ˜ì • ì—†ì´ ì‚¬ì´ë“œì¹´ë¡œ ë™ì‘ |
| **3-Tier Memory** | Hot â†’ Warm â†’ Cold ìë™ ì „ì´ |
| **3MB Guardian** | Rust ë°”ì´ë„ˆë¦¬ê°€ í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ + 5ì´ˆ ë‚´ ìë™ ë³µêµ¬ |
| **Cloud Backup** | Obsidian vault + Dropbox ìë™ ë™ê¸°í™” |

---

## ğŸŒ English Version

### ğŸ’¾ OC-Memory & ğŸ›¡ï¸ OC-Guardian

OC-Memory is an intelligent memory system that enables OpenClaw to vividly remember conversations from 90 days ago and provide fast responses without delay.

---

### ğŸ§  OC-Memory: Smart Memory Storage for AI
A system that helps AI remember what it said before and never forget.

| Feature | Technical Term | Easy Explanation |
| :--- | :--- | :--- |
| **Organized Storage** | 3-Tier Memory Architecture | Organizes memories into 3 levels, keeping important ones first. |
| **Cost Reduction** | AI Memory Compression (Mastra) | Folds memories to save up to 90% on AI usage costs. |
| **Easy Installation** | Zero-Core-Modification | Adds new capabilities without modifying the original program. |
| **Auto Cleanup** | Data Lifecycle Management (TTL) | Automatically removes old, unnecessary memories to save space. |
| **Smart Understanding** | Semantic Search | Finds what you mean even if the words are slightly different. |

---

### ğŸ›¡ï¸ OC-Guardian: Your Reliable AI Manager (NEW!!)
OC-Guardian is built with **Rust** and acts as a 'bodyguard' system that monitors and protects OpenClaw and OC-Memory to ensure stable operation.

> **"Never allows OpenClaw to stop or the server to go down."**

### âœ¨ Key Features
* **âš¡ One-Touch Execution**: Just say **"Start OC-Guardian"** to your AI. (Auto-starts OpenClaw â†’ OC-Memory in order)
* **ğŸ©º 5-Level Health Check**: Thoroughly checks the program's health across 5 levels.
* **ğŸš‘ Auto Recovery**: Self-recovers and restarts according to predefined scenarios when issues occur.
* **ğŸ§¹ Unlimited Capacity Management**: Automatically cleans up logs to prevent computer slowdown.
* **ğŸ“§ Instant Notifications**: Sends email alerts immediately when critical events like terminal restarts occur.
* **ğŸ›Œ Sleep Prevention**: Keeps programs running even when MacBook lid is closed. (MacBook sleep prevention)

---

### ğŸ› ï¸ Installation & Quick Start
```bash
# Running OC-Guardian starts all systems sequentially.
./oc-guardian start
```

| What | How |
|------|-----|
| **90% Token Savings** | 5-40x compression for massive cost reduction |
| **Zero-Core-Mod** | Works as sidecar without modifying OpenClaw source |
| **3-Tier Memory** | Automatic Hot â†’ Warm â†’ Cold transition |
| **3MB Guardian** | Rust binary handles process management + auto-recovery in 5 seconds |
| **Cloud Backup** | Auto-sync with Obsidian vault + Dropbox |

---

## Architecture

```
OpenClaw (unchanged)
    â”‚ writes logs
    â–¼
~/.openclaw/logs/session-transcripts/*.jsonl
    â”‚ tail -f monitoring
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              OC-Memory Sidecar              â”‚
â”‚                                             â”‚
â”‚  Watcher â†’ Observer â†’ Merger â†’ Reflector    â”‚
â”‚                    â”‚                        â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚         â–¼         â–¼         â–¼              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚   â”‚   Hot    â”‚   Warm   â”‚   Cold   â”‚       â”‚
â”‚   â”‚ 0-90d   â”‚ 90-365d  â”‚  365d+   â”‚       â”‚
â”‚   â”‚ ChromaDBâ”‚ Archives â”‚ Obsidian â”‚       â”‚
â”‚   â”‚ realtimeâ”‚ on-demandâ”‚ Dropbox  â”‚       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                    â”‚                        â”‚
â”‚         Unified Search Engine               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ writes memory files
    â–¼
~/.openclaw/workspace/memory/*.md
    â”‚ auto-indexed
    â–¼
OpenClaw memory_search (SQLite + sqlite-vec)
```

---

## Quick Start

### 1. Install

```bash
git clone https://github.com/[username]/oc-memory.git
cd oc-memory
pip install -r requirements.txt
```

### 2. Configure

```bash
# Interactive setup wizard (recommended)
python setup.py

# Or manual
cp config.example.yaml config.yaml
```

### 3. Run

```bash
python memory_observer.py
```

### 4. Verify

Create a test note in your watch directory:

```bash
echo "# Test Memory" > ~/Documents/notes/test.md
```

The observer detects it, processes it, and writes to `~/.openclaw/workspace/memory/`. OpenClaw auto-indexes within seconds.

---

## OC-Guardian

Rust ê¸°ë°˜ í”„ë¡œì„¸ìŠ¤ ê°€ë””ì–¸. OpenClaw + OC-Memoryë¥¼ ìë™ìœ¼ë¡œ ì‹œì‘, ëª¨ë‹ˆí„°ë§, ë³µêµ¬í•©ë‹ˆë‹¤.

```bash
# Build (~3MB binary)
cd guardian
cargo build --release

# Setup configuration
cp guardian.toml.example guardian.toml
# Edit guardian.toml to define your processes

# Start all processes in dependency order
./target/release/oc-guardian start --config guardian.toml

# Or use default config location
./target/release/oc-guardian start
```

**Available Commands**:

```bash
# Start supervisor and all processes
oc-guardian start

# Stop all processes gracefully
oc-guardian stop

# Restart specific process or all
oc-guardian restart [process-name]

# Live status table
oc-guardian status

# View logs (with follow)
oc-guardian logs [process-name] --follow --tail 50
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Name      â”‚ Status â”‚ PID  â”‚ Uptime   â”‚ Restartsâ”‚ Health    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ openclaw  â”‚ online â”‚ 1234 â”‚ 10m 5s   â”‚ 0       â”‚ âœ“ Healthy â”‚
â”‚ oc-memory â”‚ online â”‚ 5678 â”‚ 9m 55s   â”‚ 0       â”‚ âœ“ Healthy â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Features

| Feature | Detail |
|---------|--------|
| **5-Level Health Check** | Process alive â†’ Log activity â†’ Config validation â†’ Resource monitoring â†’ HTTP endpoint |
| **6 Recovery Scenarios** | invalid_json, process_crash, unresponsive, memory_leak, network_timeout, llm_error |
| **Dependency-based Start** | Topological sort ensures correct startup order |
| **Log Rotation** | Size-based with generational backups |
| **Memory Compression** | Dual-trigger: token threshold (30K) + 24h schedule |
| **macOS Sleep Prevention** | Automatic `caffeinate` management |
| **Email Alerts** | SMTP notifications for crashes and recovery events |

### Run in Background

**Option 1: nohup/screen (quick)**

```bash
# nohup
nohup ./target/release/oc-guardian start &

# screen
screen -S guardian
./target/release/oc-guardian start
# Press Ctrl+A, D to detach
```

**Option 2: System Service (recommended)**

```bash
# Linux (systemd)
cd guardian/service && sudo ./install-service.sh install
sudo systemctl start oc-guardian

# macOS (launchd)
cd guardian/service && ./install-service.sh install
launchctl start com.openclaw.guardian

# Windows (Scheduled Task)
cd guardian\service && .\install-service.ps1 -Action install
```

**Note**: Guardian runs in foreground as supervisor. OpenClaw and OC-Memory run as child processes managed by Guardian.

See [guardian/README.md](guardian/README.md) for full documentation.

---

## Tech Stack

| Layer | Technology |
|-------|-----------|
| **Memory Engine** | Python 3.8+, ChromaDB, watchdog |
| **Process Guardian** | Rust 2021, tokio, clap, sysinfo |
| **LLM** | OpenAI GPT-4o-mini, Google Gemini |
| **Cloud** | Obsidian vault, Dropbox API |
| **Service** | systemd, launchd, Windows Scheduled Task |
| **CI/CD** | GitHub Actions (Windows + macOS + Linux) |

---

## Project Structure

```
oc-memory/
â”œâ”€â”€ lib/                  # Python core (15 modules)
â”‚   â”œâ”€â”€ config.py         # YAML configuration
â”‚   â”œâ”€â”€ file_watcher.py   # Directory monitoring
â”‚   â”œâ”€â”€ memory_writer.py  # OpenClaw memory integration
â”‚   â”œâ”€â”€ observer.py       # LLM-based extraction
â”‚   â”œâ”€â”€ memory_merger.py  # Deduplication & merge
â”‚   â”œâ”€â”€ reflector.py      # Periodic summarization
â”‚   â”œâ”€â”€ memory_store.py   # ChromaDB vector store
â”‚   â”œâ”€â”€ ttl_manager.py    # Hot/Warm/Cold transitions
â”‚   â”œâ”€â”€ unified_search.py # 3-tier search engine
â”‚   â”œâ”€â”€ obsidian_client.py# Obsidian vault CRUD
â”‚   â”œâ”€â”€ dropbox_sync.py   # Dropbox sync
â”‚   â”œâ”€â”€ error_handler.py  # Retry & error handling
â”‚   â”œâ”€â”€ api_detector.py   # LLM API auto-detection
â”‚   â””â”€â”€ error_notifier.py # Error notifications
â”œâ”€â”€ guardian/              # Rust process guardian
â”‚   â”œâ”€â”€ src/              # 11 Rust modules
â”‚   â”œâ”€â”€ service/          # systemd, launchd, Windows templates
â”‚   â””â”€â”€ README.md         # Guardian docs
â”œâ”€â”€ tests/                # 164 Python tests
â”œâ”€â”€ specs/                # BRD, PRD, Tech Spec, Tasks
â”œâ”€â”€ scripts/              # Build & install scripts
â”œâ”€â”€ memory_observer.py    # Main daemon
â”œâ”€â”€ setup.py              # TUI setup wizard
â””â”€â”€ config.example.yaml   # Example configuration
```

---

## Testing

```bash
# Python tests (164 tests)
pytest

# Guardian tests (64 tests)
cd guardian && cargo test
```

---

## Documentation

| Document | Description |
|----------|-------------|
| [specs/BRD.md](specs/BRD.md) | Business Requirements |
| [specs/PRD.md](specs/PRD.md) | Product Requirements |
| [specs/Tech_Spec.md](specs/Tech_Spec.md) | Technical Specification |
| [specs/Tasks.md](specs/Tasks.md) | Implementation Tasks (4 Phase, 11 weeks) |
| [guardian/README.md](guardian/README.md) | Guardian detailed documentation |
| [Patch_note/RELEASE_v1.0.md](Patch_note/RELEASE_v1.0.md) | v1.0 Release Notes |

---

## Contributing

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

---

## License

MIT License - see [LICENSE](LICENSE)

---

## Acknowledgments

- [Mastra](https://mastra.ai/) â€” Observational Memory concept
- [OpenClaw](https://openclaw.ai/) â€” Open-source AI agent framework
- [Obsidian](https://obsidian.md/) â€” Knowledge management
- [ChromaDB](https://www.trychroma.com/) â€” AI-native vector database
